TCP can also perform basic stateful firewall services using the TCP **established** keyword. The keyword enables inside traffic to exit the inside private network and permits the returning reply traffic to enter the inside private network, as shown in the figure.

![[5.4.6_1.png]]

However, TCP traffic generated by an outside host and attempting to communicate with an inside host is denied.

The **established** keyword can be used to permit only the return HTTP traffic from requested websites, while denying all other traffic.

In the topology, the design for this example shows that ACL 110, which was previously configured, will filter traffic from the inside private network. ACL 120, using the **established** keyword, will filter traffic coming into the inside private network from the outside public network.

![[5.4.6_2.png]]

In the example, ACL 120 is configured to only permit returning web traffic to the inside hosts. The new ACL is then applied outbound on the R1 G0/0/0 interface. The **show access-lists** command displays both ACLs. Notice from the match statistics that inside hosts have been accessing the secure web resources from the internet.

```
R1(config)# **access-list 120 permit tcp any 192.168.10.0 0.0.0.255 established**
R1(config)# **interface g0/0/0**
R1(config-if)# **ip access-group 120 out**
R1(config-if)# **end**
R1# **show access-lists**
Extended IP access list 110
    10 permit tcp 192.168.10.0 0.0.0.255 any eq www
    20 permit tcp 192.168.10.0 0.0.0.255 any eq 443 (657 matches) 
Extended IP access list 120
    10 permit tcp any 192.168.10.0 0.0.0.255 established (1166 matches) 
R1#
```

Notice that the permit secure HTTPS counters (i.e., eq 443) in ACL 110 and the return established counters in ACL 120 have increased.

The **established** parameter allows only responses to traffic that originates from the 192.168.10.0/24 network to return to that network. Specifically, a match occurs if the returning TCP segment has the ACK or reset (RST) flag bits set. This indicates that the packet belongs to an existing connection. Without the **established** parameter in the ACL statement, clients could send traffic to a web server, and receive traffic returning from the web server. All traffic would be permitted.