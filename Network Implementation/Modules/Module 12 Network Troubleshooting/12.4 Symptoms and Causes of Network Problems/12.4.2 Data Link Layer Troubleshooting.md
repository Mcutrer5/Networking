Troubleshooting Layer 2 problems can be a challenging process. The configuration and operation of these protocols are critical to creating a functional, well-tuned network. Layer 2 problems cause specific symptoms that, when recognized, will help identify the problem quickly.

The figure summarizes the symptoms and causes of data link layer network problems.

![[12.4.2.png]]

The table lists common symptoms of data link layer network problems.

|**Symptom**|**Description**|
|---|---|
|**No functionality or connectivity at the network layer or above**|Some Layer 2 problems can stop the exchange of frames across a link, while others only cause network performance to degrade.|
|**Network is operating below baseline performance levels**|- There are two distinct types of suboptimal Layer 2 operation that can occur in a network.<br>- First, the frames take a suboptimal path to their destination but do arrive causing the network to experience unexpected high-bandwidth usage on links.<br>- Second, some frames are dropped as identified through error counter statistics and console error messages that appear on the switch or router.<br>- An extended or continuous ping can help reveal if frames are being dropped.|
|**Excessive broadcasts**|- Operating systems use broadcasts and multicasts extensively to discover network services and other hosts.<br>- Generally, excessive broadcasts are the result of a poorly programmed or configured applications, a large Layer 2 broadcast domain, or an underlying network problem (e.g., STP loops or route flapping).|
|**Console messages**|- A router recognizes that a Layer 2 problem has occurred and sends alert messages to the console.<br>- Typically, a router does this when it detects a problem with interpreting incoming frames (encapsulation or framing problems) or when keepalives are expected but do not arrive.<br>- The most common console message that indicates a Layer 2 problem is a line protocol down message|

The table lists issues that commonly cause network problems at the data link layer.

| **Problem Cause**          | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Encapsulation errors**   | - An encapsulation error occurs because the bits placed in a field by the sender are not what the receiver expects to see.<br>- This condition occurs when the encapsulation at one end of a WAN link is configured differently from the encapsulation used at the other end.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Address mapping errors** | - In topologies, such as point-to-multipoint or broadcast Ethernet, it is essential that an appropriate Layer 2 destination address be given to the frame. This ensures its arrival at the correct destination.<br>- To achieve this, the network device must match a destination Layer 3 address with the correct Layer 2 address using either static or dynamic maps.<br>- In a dynamic environment, the mapping of Layer 2 and Layer 3 information can fail because devices may have been specifically configured not to respond to ARP requests, the Layer 2 or Layer 3 information that is cached may have physically changed, or invalid ARP replies are received because of a misconfiguration or a security attack.                                                                                                                                                                                                                                                                                                                                          |
| **Framing errors**         | - Frames usually work in groups of 8-bit bytes.<br>- A framing error occurs when a frame does not end on an 8-bit byte boundary.<br>- When this happens, the receiver may have problems determining where one frame ends, and another frame starts.<br>- Too many invalid frames may prevent valid keepalives from being exchanged.<br>- Framing errors can be caused by a noisy serial line, an improperly designed cable (too long or not properly shielded), faulty NIC, duplex mismatch, or an incorrectly configured channel service unit (CSU) line clock.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **STP failures or loops**  | - The purpose of the Spanning Tree Protocol (STP) is to resolve a redundant physical topology into a tree-like topology by blocking redundant ports.<br>- Most STP problems are related to forwarding loops that occur when no ports in a redundant topology are blocked and traffic is forwarded in circles indefinitely. This causes excessive flooding because of a high rate of STP topology changes.<br>- A topology change should be a rare event in a well-configured network.<br>- When a link between two switches goes up or down, there is eventually a topology change when the STP state of the port is changing to or from forwarding.<br>- However, when a port is flapping (oscillating between up and down states), this causes repetitive topology changes and flooding, or slow STP convergence or re-convergence.<br>- This can be caused by a mismatch between the real and documented topology, a configuration error, such as an inconsistent configuration of STP timers, an overloaded switch CPU during convergence, or a software defect. |